<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="movie">

	<select id="findAll" resultType="MovieDto">
		select * from movie order by
		movie_release_date desc
	</select>

	<select id="findByMovieName" resultType="MovieDto">
		select * from movie
		where instr(movie_name, #{movieName}) > 0
		order by movie_release_date
		desc
	</select>

	<insert id="save">
		insert into movie
		values(movie_seq.nextval, #{movieName}, #{movieReleaseDate},
		#{movieDirector}, #{movieTime},
		#{movieLevel}, #{movieNation},
		#{movieContent})
	</insert>

	<delete id="deleteByMovieNo">
		delete from movie where movie_no = #{movieNo}
	</delete>

	<update id="change">
		update movie
		<set>
			<if test="movieDto.movieName != null">
				movie_name = #{movieDto.movieName},
			</if>
			<if test="movieDto.movieReleaseDate != null">
				movie_release_date = #{movieDto.movieReleaseDate},
			</if>
			<if test="movieDto.movieDirector != null">
				movie_director = #{movieDto.movieDirector},
			</if>
			<if test="movieDto.movieTime > 0">
				movie_time = #{movieDto.movieTime},
			</if>
			<if test="movieDto.movieLevel != null">
				movie_level = #{movieDto.movieLevel},
			</if>
			<if test="movieDto.movieNation != null">
				movie_nation = #{movieDto.movieNation},
			</if>
			<if test="movieDto.movieContent != null">
				movie_content = #{movieDto.movieContent},
			</if>
		</set>
		where movie_no = #{movieNo}
	</update>

</mapper>